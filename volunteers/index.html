<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="UTF-8" />
      <title>Volunteers Data View</title>
      <style>
            table {
                  border-collapse: collapse;
                  width: 100%;
            }

            th,
            td {
                  padding: 8px;
                  border: 1px solid #bbb;
                  text-align: center;
            }

            th {
                  background: #ece6fa;
            }

            #content {
                  display: none;
            }
      </style>
      <!-- Firebase SDKs -->
      <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
      <!-- SheetJS for Excel Export -->
      <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
      <div id="content">
            <button id="downloadExcel"
                  style="margin:18px 0 9px 0; padding:8px 20px; font-weight:600; background:#14bbc6; color:#fff; border:none; border-radius:8px; cursor:pointer;">
                  Download Excel
            </button>

            <h2>Registered Volunteers</h2>
            <table id="dataTable">
                  <thead>
                        <tr>
                              <th rowspan="2">No.</th>
                              <th rowspan="2">Department Name</th>
                              <th rowspan="2">Program Name</th>
                              <th rowspan="2">Team Name</th>
                              <th colspan="3">Member-1</th>
                              <th colspan="3">Member-2</th>
                              <th rowspan="2">Analytical Tools</th>
                              <th rowspan="2">Proficiency (Data Preprocessing)</th>
                              <th rowspan="2">Proficiency (Machine Learning)</th>
                              <th rowspan="2">Other Specific Tools</th>
                        </tr>
                        <tr>
                              <th>name</th>
                              <th>En no</th>
                              <th>Mo NO</th>
                              <th>name</th>
                              <th>En no</th>
                              <th>Mo NO</th>
                        </tr>
                  </thead>
                  <tbody></tbody>
            </table>
      </div>

      <script>
            // Download Excel button logic
            document.getElementById('downloadExcel').addEventListener('click', () => {
                  const table = document.getElementById('dataTable');
                  const wb = XLSX.utils.table_to_book(table, { sheet: "Registrations" });
                  XLSX.writeFile(wb, 'Volunteers.xlsx');
            });
      </script>

      <script>
            const userId = prompt("Enter ID:");
            const password = prompt("Enter Password:");

            function loadFirebaseData() {
                  const dbRef = firebase.database().ref("registration");
                  const tbody = document.querySelector("#dataTable tbody");

                  dbRef.on("value", (snapshot) => {
                        tbody.innerHTML = "";
                        let no = 1;
                        snapshot.forEach((child) => {
                              const data = child.val();
                              const tr = document.createElement("tr");
                              tr.innerHTML = `
                    <td>${no++}</td>
                    <td>${data.department || ""}</td>
                    <td>${data.program || ""}</td>
                    <td>${data.team || ""}</td>
                    <td>${data.member1_name || ""}</td>
                    <td>${data.member1_enrollment || ""}</td>
                    <td>${data.member1_mobile || ""}</td>
                    <td>${data.member2_name || ""}</td>
                    <td>${data.member2_enrollment || ""}</td>
                    <td>${data.member2_mobile || ""}</td>
                    <td>${data.analytical_tools || ""}</td>
                    <td>${data.data_preprocessing || ""}</td>
                    <td>${data.ml_proficiency || ""}</td>
                    <td>${data.other_tools || ""}</td>
                `;
                              tbody.appendChild(tr);
                        });
                  });
            }

            if (userId === "volunteers" && password === "Secret@123") {
                  document.getElementById('content').style.display = 'block';
                  // Load Firebase data after showing content
                  loadFirebaseData();
            } else {
                  alert("Invalid credentials! Access denied.");
                  document.body.innerHTML = "<h2 style='text-align:center; color:red;'>Access Denied</h2>";
            }
      </script>

</body>

</html>